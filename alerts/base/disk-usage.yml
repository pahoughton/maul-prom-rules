# 2019-02-10 (cc) <paul4hough@gmail.com>
#
---
groups:
- name: disk-usage
  rules:
  - record: fed:node_filesystem_free_bytes
    expr: min(node_filesystem_free_bytes[1h])
  - record: fed:node_filesystem_size_bytes
    expr: min(node_filesystem_size_bytes[1h])
  - record: node_filesystem_free_bytes_min
    expr: 0.1
  - alert: disk-usage
    expr: >-
      node_filesystem_free_bytes
      / node_filesystem_size_bytes
      < node_filesystem_free_bytes_min
    annotations:
      title: disk space low on {{ $labels.mountpoint }}
    labels:
      notify_group: maul/alerts
